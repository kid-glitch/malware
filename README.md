# malware

LAB 1:

![image](https://user-images.githubusercontent.com/72652376/140474437-5328f404-13bc-450b-96f4-cb3b911e4e7a.png)

![image](https://user-images.githubusercontent.com/72652376/140474786-8aad7e34-9d23-4e6d-bea6-7f503e1a83ff.png)


sử dụng pe view để có thể xem thời gian chương trình này được biên dịch

![image](https://user-images.githubusercontent.com/72652376/140474949-d4a7bc5f-3616-4f35-9a1f-8caa74f4dc9e.png)

![image](https://user-images.githubusercontent.com/72652376/140475084-8a3da584-2ab6-444b-80d5-ccdce7a29ee2.png)

2 chương trình này đều không được pack hay xáo trộn. Nó đang được biên dịch bằng Microsoft Visual C ++ 6.0 

![image](https://user-images.githubusercontent.com/72652376/140475251-13dff84d-4977-4571-834a-5540e7aab136.png)

Ngoài ra có thể thấy giữa kích thước ảo với kích thước thô của tệp cũng sêm sêm như nhau

![image](https://user-images.githubusercontent.com/72652376/140479507-5fa10ffb-fafc-419f-a9c2-00d23f2bb02e.png)

Chương trình sử dụng 3 thư viện là 

KERNEL32.dll : thư viện này là thư viện cốt lõi của windows bao gồm các chức năng như thao tác bộ nhớ, tệp và phần cứng. Chương trình này sử dụng một số hàm như nổi bật 

FindFirstFileA
FindNextFileA
Sleep
CreateProcessA

MSVCRT.dll : thư viện này cung cấp các chức năng về kết nối mạng 
WS2_32.dll : thư viện cung cấp trình biên dịch cho ngôn ngữ lập trình

Kiểm tra phần MSVCRT.dll có thể thấy được 

![image](https://user-images.githubusercontent.com/72652376/140481507-cb4c2e21-180f-41f1-8152-9e72569c326b.png)

Các hàm được đánh số như là: 
closesocket
connect
htons
inet_addr
recv
send
shutdown
socket
WSAStartup
WSACleanup

Có thể suy ra được rằng chương trình cố gắng kết nối với 1 mạng hoặc ip bên ngoài nào đó bằng cách mở 1 socket để gửi nhận các gói tin

![image](https://user-images.githubusercontent.com/72652376/140482079-ab5be21c-f509-4a51-bba5-c04bd6b265b4.png)

Kiểm tra thư viện này WS2_32.dll cho thấy nó sử dụng C++ và có sử dụng đến việc khai báo bộ nhớ và 1 hàm nhập vào của C++

![image](https://user-images.githubusercontent.com/72652376/140482960-2df09b56-e582-40fd-bcbc-926ed35d138d.png)

Kiểm tra strings trên 2 file .exe và .dll thì thấy được rằng
- file .exe tham chiếu đến tệp ngụy trang có tên là C:\windows\system32\kerne132.dll (thay số 1 bằng chữ L)
- File .dll thì có thể thấy 1 địa chỉ ip mà nó cố gắng kết nối đến

Tổng kết: Dựa trên mọi thứ chúng tôi đã liệt kê ở trên, đoán rằng tệp thực thi được sử dụng để chạy DLL hoạt động như một cửa sau hoặc trojan truy cập từ xa (RAT). Dựa trên các lần nhập, có thể thực thi tìm kiếm để xem liệu C: \ windows \ system32 \ kerne132.dll có tồn tại hay không và nếu không, nó có thể cố gắng sao chép DLL độc hại sang C: \ windows \ system32 \ kerne132.dll được sử dụng. Khi thực thi DLL, nó có khả năng liên hệ với máy chủ C2 tại 127.26.152.13.
